p Hej #{brugernavn}
p Dette er chatten
//- Todo:
//- https://gyazo.com/46f236163b555a7afba59f83ff2a23f6	- notifikationer?

div(style="border: 5px solid black; border-radius: 5px; overflow-y: scroll; height: 70%;", id="chat")
input(type="text", placeholder="message", id="mes")
input(type="button", value="Send besked", onclick="sendChat()")

script.

	document.getElementById("mes").addEventListener("keydown", function (e) {
		if (e.keyCode === 13) {  //checks whether the pressed key is "Enter"
			sendChat()
		}
	});

	var xhr = new XMLHttpRequest();
	xhr.open('POST', "../getchat", true)
	xhr.onreadystatechange = (e) => {
		if (xhr.readyState == 4 && xhr.status == 200) {
			var response = JSON.parse(xhr.responseText);
			document.getElementById("chat").innerHTML = ""
			for (let i = 0; i < response.length; i++) {
				const element = response[i];
				document.getElementById("chat").innerHTML += "<p>" + element + "</p>"
			}
		}
	}
	xhr.setRequestHeader("Content-Type", "application/json")
	xhr.send(JSON.stringify({username: "#{brugernavn}", password: "#{password}"}));

	setInterval(() => {
		var xhr = new XMLHttpRequest();
		xhr.open('POST', "../getchat", true)
		xhr.onreadystatechange = (e) => {
			if (xhr.readyState == 4 && xhr.status == 200) {
				var response = JSON.parse(xhr.responseText);
				document.getElementById("chat").innerHTML = ""
				for (let i = 0; i < response.length; i++) {
					const element = response[i];
					document.getElementById("chat").innerHTML += "<p>" + element + "</p>"
				}
			}
		}
		xhr.setRequestHeader("Content-Type", "application/json")
		xhr.send(JSON.stringify({username: "#{brugernavn}", password: "#{password}"}));
		}, 3000);
	function sendChat() {
		if(!document.getElementById("mes").value == "") {
			var xhr = new XMLHttpRequest();
			xhr.open('POST', "../sendchat", true)
			xhr.setRequestHeader("Content-Type", "application/json")
			xhr.onreadystatechange = (e) => {
				var xhr = new XMLHttpRequest();
				xhr.open('POST', "../getchat", true)
				xhr.onreadystatechange = (e) => {
					if (xhr.readyState == 4 && xhr.status == 200) {
						var response = JSON.parse(xhr.responseText);
						document.getElementById("chat").innerHTML = ""
						for (let i = 0; i < response.length; i++) {
							const element = response[i];
							document.getElementById("chat").innerHTML += "<p>" + element + "</p>"
						}
					}
					var objDiv = document.getElementById("chat");
					objDiv.scrollTop = objDiv.scrollHeight;
				}
				xhr.setRequestHeader("Content-Type", "application/json")
				xhr.send(JSON.stringify({username: "#{brugernavn}", password: "#{password}"}));
				document.getElementById("mes").value = ""
			}
			xhr.send(JSON.stringify({username: "#{brugernavn}", password: "#{password}", message: document.getElementById("mes").value}));
		}
	}